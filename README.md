# AnonCam

AnonCam - это приложение для анонимизации лиц в реальном времени с использованием веб-камеры. Приложение использует компьютерное зрение для обнаружения лиц и применяет различные методы анонимизации для защиты приватности.

## Возможности

- **Обнаружение лиц в реальном времени** - использует MediaPipe для точного обнаружения лиц
- **Множественные режимы анонимизации**:
  - **Авто** - автоматически переключается между режимами в зависимости от наличия лиц
  - **Лица** - анонимизирует только обнаруженные лица
  - **Все** - применяет анонимизацию ко всему кадру
  - **Нет** - отключает анонимизацию
- **Настраиваемая сила анонимизации** - от 1 до 10 уровней
- **Плавные переходы** - настраиваемое размытие краев масок
- **Виртуальная камера** - вывод в виртуальную камеру для использования в других приложениях
- **Черно-белый режим** - опциональный монохромный вывод
- **Детальная настройка** - множество параметров для точной настройки

## Установка

### Требования

- Python 3.8+
- macOS (тестировалось на macOS)
- Веб-камера

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Быстрая установка (macOS)

Используйте скрипт установки:

```bash
chmod +x install-macos.sh
./install-macos.sh
```

## Использование

### Запуск приложения

```bash
python anon_cam.py
```

### Основные настройки

- **Режим**: Выберите режим анонимизации
- **Сила**: Уровень анонимизации (1-10)
- **Перо**: Размытие краев масок (0-60)
- **Только крупнейшее**: Анонимизировать только самое большое лицо
- **Порог детекции**: Чувствительность обнаружения лиц (0-100%)
- **Ч/Б вывод**: Черно-белый режим

### Дополнительные настройки

- **Miss thresh**: Количество кадров без лиц для переключения режима
- **Recover frames**: Количество кадров для восстановления режима
- **Det every**: Частота обнаружения лиц (каждый N-й кадр)
- **Det width**: Ширина кадра для обнаружения (160-960px)
- **Увеличение маски**: Расширение области анонимизации (0-100%)

## Технические детали

### Архитектура

- **`app.py`** - Точка входа приложения
- **`ui.py`** - PyQt6 интерфейс пользователя
- **`engine.py`** - Основной движок анонимизации
- **`detector.py`** - Обнаружение лиц с помощью MediaPipe
- **`anonymize.py`** - Алгоритмы анонимизации
- **`logging_utils.py`** - Утилиты логирования

### Алгоритмы анонимизации

Приложение использует необратимые методы анонимизации:

1. **Квантование** - уменьшение количества цветовых уровней
2. **Добавление шума** - случайный шум для деградации качества
3. **Блочное перемешивание** - перестановка блоков изображения
4. **Размытие** - гауссово размытие для сглаживания

### Производительность

- Оптимизированное обнаружение лиц (каждый N-й кадр)
- Настраиваемое разрешение для обнаружения
- Кэширование результатов обнаружения
- Эффективная обработка кадров

## Виртуальная камера

Для использования виртуальной камеры установите дополнительную зависимость:

```bash
pip install pyvirtualcam
```

После установки активируйте опцию "Вывод в виртуальную камеру" в интерфейсе.

## Логирование

Приложение включает встроенную систему логирования:

- Нажмите кнопку "Логи" для открытия окна логов
- Логи отображают информацию о работе обнаружения лиц
- Переключения между режимами анонимизации
- Ошибки и предупреждения

## Устранение неполадок

### Проблемы с камерой

- Убедитесь, что камера не используется другими приложениями
- Проверьте разрешения доступа к камере в настройках системы

### Низкая производительность

- Увеличьте значение "Det every" (реже обнаружение)
- Уменьшите "Det width" (меньшее разрешение для обнаружения)
- Уменьшите "Сила" анонимизации

### Проблемы с виртуальной камерой

- Убедитесь, что установлен пакет `pyvirtualcam`
- Проверьте, что виртуальная камера не используется другими приложениями

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл LICENSE для подробностей.

## Вклад в проект

Мы приветствуем вклад в развитие проекта! Пожалуйста:

1. Форкните репозиторий
2. Создайте ветку для новой функции
3. Внесите изменения
4. Создайте Pull Request

## Поддержка

Если у вас возникли проблемы или вопросы:

1. Проверьте раздел "Устранение неполадок"
2. Создайте Issue в репозитории GitHub
3. Приложите логи из окна "Логи" приложения